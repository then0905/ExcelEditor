# Excel編輯器

![示意圖](https://github.com/user-attachments/assets/8ef0ca77-3b8e-4ff3-8693-67ab0120cafa)

##  前言

![前言](https://github.com/user-attachments/assets/352bc0aa-dcd0-4f64-9373-87d89ad35eb1)

撰寫的靈感源自於某天打開遊戲的 DB (用 Excel 製作),密密麻麻的資料讓人眼花撩亂,想到日後需要打開來調整數值,即使使用搜尋功能應該也會看得很煩躁。

於是我決定嘗試開發一個編輯器來修改 Excel 的內容。

---

##  使用說明

### 表格的格式

![表格的格式](https://github.com/user-attachments/assets/2813b301-89b3-4082-a911-0a9fa8669191)

- **標題欄請放在第一行**
- **工作表的命名必須以 `.json` 結尾**才會被編輯器讀取
- 其他用於筆記的表格,正常命名即可,不要以 `.json` 結尾

### Excel 工作表的命名方式

![說明圖](https://github.com/user-attachments/assets/e4d1ff46-9540-44f6-839d-e28ecbc708c8)

資料採用**主從結構**:

- 以示意圖為例,`skill.json` 是主表,以 `SkillID` 為主鍵
- 相關的一對多資料會拆分成具名子表
- **子表命名規則**為 `skill.json#XXX`,其中 `XXX` 可自行命名,但格式必須遵守此規則
- **子表第一欄必須是 `SkillID` 作為 foreign key**

### 編輯器的配置設定

![編輯器配置](https://github.com/user-attachments/assets/7c0d8a0e-ca21-46e2-962b-484949a5a5a8)

首次匯入未記錄過的 Excel 時會彈出配置提示視窗。

**主畫面右上角的「配置設定」按鈕也可開啟此視窗**

#### 外部文字表

- 通常不需要設定(此功能是針對遊戲中使用多語系 Excel 的需求)
- ![文字表](https://github.com/user-attachments/assets/97fb48c1-bb1d-4e2f-9b7e-5221b85e34ce)
- 如果需要此設定,請將文字表格式設為:第一列為文字 ID,第二列為文字內容(標題列命名不限)
- 表內資料需與外部文字表的文字 ID 對應才能讀取到文字內容
- 勾選後,修改並儲存 Excel 時會同步更新外部文字表的資料

#### 圖片設定

- 啟用後,圖片路徑請與 exe 放在同一層
- 圖片路徑可以是:
  - `{你指定的資料夾}/{分類ID}/{清單選取的內容}.png`
  - `{你指定的資料夾}/{清單選取的內容}.png`

#### 母表分類設定

母表是否需要分類,取決於資料的使用與管理需求:

- **需要分類的情況**  
  例如「技能資料」:
  - 技能本身是一筆筆獨立的資料
  - 但實務上會依「職業」進行管理
  - 因此母表會先以「職業」作為分類,再顯示該職業底下的技能清單

- **不需要分類的情況**  
  例如「怪物資料」:
  - 不需要額外的分類層級
  - 每筆資料僅以 MonsterID 作為唯一識別
  - 因此母表採用單層結構,不再進一步分類

#### 欄位的資料類別

母表與子表的設定大致相同,欄位可選類別有:

- **String**: 單純字串
- **int**: 整數
- **float**: 小數
- **bool**: 一個 CheckBox,打勾即為 True
- **enum**: 下拉式選單,選擇後需手動輸入選單內容,並以逗號 `,` 分隔

---

### 多個主表與子表的 Excel

![多個主表與子表的Excel](https://github.com/user-attachments/assets/c7f92e33-e07c-470f-81ad-0738d0735c8d)

- 當 Excel 包含多個主表與子表時,配置設定視窗和主畫面都會提供 Tab 進行切換(如示意圖)
- **請注意確認已切換到正確的 Tab**

---

### 資料的新增與刪除

- 除了編輯功能外,分類、子表與清單都提供刪除與新增按鈕
- 讓您能更靈活地操作資料以符合需求

---

##  結語

希望這個編輯器能幫助到有需要的人 (例如:我)

---
